<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="true" />








  <meta name="baidu-site-verification" content="7CWHgjuR2X" />







  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="React," />





  <link rel="alternate" href="/atom.xml" title="Honey Young" type="application/atom+xml" />






<meta name="description" content="React 是 Facebook 开源的一个用于构建用户界面的 Javascript 库，已经 应用于 Facebook 及旗下 Instagram。 和庞大的 AngularJS 不同，React 专注于 MVC 架构中的 V，即视图。 这使得 React 很容易和开发者已有的开发栈进行融合。 React 顺应了 Web 开发组件化的趋势。应用 React 时，应该从 UI 出发抽象出不同的组件">
<meta name="keywords" content="React">
<meta property="og:type" content="article">
<meta property="og:title" content="React 学习笔记">
<meta property="og:url" content="http://yoursite.com/2017/07/07/React学习笔记/index.html">
<meta property="og:site_name" content="Honey Young">
<meta property="og:description" content="React 是 Facebook 开源的一个用于构建用户界面的 Javascript 库，已经 应用于 Facebook 及旗下 Instagram。 和庞大的 AngularJS 不同，React 专注于 MVC 架构中的 V，即视图。 这使得 React 很容易和开发者已有的开发栈进行融合。 React 顺应了 Web 开发组件化的趋势。应用 React 时，应该从 UI 出发抽象出不同的组件">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/images/React001.png">
<meta property="og:image" content="http://yoursite.com/images/React002.png">
<meta property="og:image" content="http://yoursite.com/images/React003.png">
<meta property="og:image" content="http://yoursite.com/images/React004.png">
<meta property="og:image" content="http://yoursite.com/images/React005.png">
<meta property="og:image" content="http://yoursite.com/images/React006.png">
<meta property="og:image" content="http://yoursite.com/images/React007.png">
<meta property="og:updated_time" content="2018-06-07T07:01:36.986Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="React 学习笔记">
<meta name="twitter:description" content="React 是 Facebook 开源的一个用于构建用户界面的 Javascript 库，已经 应用于 Facebook 及旗下 Instagram。 和庞大的 AngularJS 不同，React 专注于 MVC 架构中的 V，即视图。 这使得 React 很容易和开发者已有的开发栈进行融合。 React 顺应了 Web 开发组件化的趋势。应用 React 时，应该从 UI 出发抽象出不同的组件">
<meta name="twitter:image" content="http://yoursite.com/images/React001.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'honey young'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/07/07/React学习笔记/"/>





  <title>React 学习笔记 | Honey Young</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Honey Young</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">小杨鹤</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/07/React学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="honey young">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/header.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Honey Young">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">React 学习笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-07T00:00:00+08:00">
                2017-07-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/React系列/" itemprop="url" rel="index">
                    <span itemprop="name">React系列</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>React 是 Facebook 开源的一个用于构建用户界面的 Javascript 库，已经 应用于 Facebook 及旗下 Instagram。</p>
<p>和庞大的 AngularJS 不同，React 专注于 MVC 架构中的 V，即视图。 这使得 React 很容易和开发者已有的开发栈进行融合。</p>
<p>React 顺应了 Web 开发组件化的趋势。应用 React 时，应该从 UI 出发抽象出不同的组件，然后像搭积木一样把它们拼装起来。</p>
<a id="more"></a>
<h2 id="React简介"><a href="#React简介" class="headerlink" title="React简介"></a>React简介</h2><p>这个项目本身也越滚越大，从最早的 UI 引擎变成了一整套前后端通吃的 Web App 解决方案。衍生的 React Native 项目，目标更是宏伟，希望用写 Web App 的方式去写 Native App。如果能够实现，整个互联网行业都会被颠覆，因为同一组人只需要写一次 UI ，就能同时运行在服务器、浏览器和手机。</p>
<h3 id="官网地址"><a href="#官网地址" class="headerlink" title="官网地址"></a>官网地址</h3><p>英文网：<a href="http://facebook.github.io/react/docs/getting-started.html" target="_blank" rel="noopener">http://facebook.github.io/react/docs/getting-started.html</a></p>
<p>中文网：<a href="http://reactjs.cn/react/docs/getting-started.html" target="_blank" rel="noopener">http://reactjs.cn/react/docs/getting-started.html</a></p>
<h3 id="在线编辑工具-JSFiddle"><a href="#在线编辑工具-JSFiddle" class="headerlink" title="在线编辑工具 JSFiddle"></a>在线编辑工具 JSFiddle</h3><p>在线编辑工具，可以方便快速学习 react 基本语法</p>
<h3 id="为什么使用-React"><a href="#为什么使用-React" class="headerlink" title="为什么使用 React"></a>为什么使用 React</h3><p>我们创造 React 是为了解决一个问题：构建随着时间数据不断变化的大规模应用程序。为了达到这个目标，React 采用下面两个主要的思想。</p>
<p>1、简单</p>
<p>仅仅只要表达出应用程序在任一个时间点应该长的样子，然后当底层的数据变了，React 会自动处理所有用户界面的更新。</p>
<p>2、声明式 (Declarative)</p>
<p>数据变化后，React 概念上与点击“刷新”按钮类似，但仅会更新变化的部分。</p>
<p>3、构建可组合的组件</p>
<p>React 都是关于构建可复用的组件。事实上，通过 React 唯一要做的事情就是构建组件。得益于其良好的封装性，组件使代码复用、测试和关注分离（separation of concerns）更加简单。</p>
<p>更多原因 <a href="http://facebook.github.io/react/blog/2013/06/05/why-react.html" target="_blank" rel="noopener">http://facebook.github.io/react/blog/2013/06/05/why-react.html</a></p>
<h3 id="实战案例"><a href="#实战案例" class="headerlink" title="实战案例"></a>实战案例</h3><p><a href="http://info.smartstudy.com/" target="_blank" rel="noopener">http://info.smartstudy.com/</a><br><a href="http://www.kongkonghu.com/choice" target="_blank" rel="noopener">http://www.kongkonghu.com/choice</a><br><a href="https://github.com/webpack/react-starter" target="_blank" rel="noopener">https://github.com/webpack/react-starter</a></p>
<h3 id="入门视频"><a href="#入门视频" class="headerlink" title="入门视频"></a>入门视频</h3><p><a href="https://www.youtube.com/watch?v=7eLqKgp0eeY" target="_blank" rel="noopener">https://www.youtube.com/watch?v=7eLqKgp0eeY</a><br><a href="https://www.youtube.com/watch?v=fZKaq623y38&amp;list=PLQDnxXqV213JJFtDaG0aE9vqvp6Wm7nBg" target="_blank" rel="noopener">https://www.youtube.com/watch?v=fZKaq623y38&amp;list=PLQDnxXqV213JJFtDaG0aE9vqvp6Wm7nBg</a><br><a href="https://www.youtube.com/watch?v=QQK5hpUuOuA&amp;list=PLUAEXpf1UDMkzPOiNJBrlqsUryn7n2cnK" target="_blank" rel="noopener">https://www.youtube.com/watch?v=QQK5hpUuOuA&amp;list=PLUAEXpf1UDMkzPOiNJBrlqsUryn7n2cnK</a></p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://github.com/dingyiming/learn-Js-react/issues/1" target="_blank" rel="noopener">https://github.com/dingyiming/learn-Js-react/issues/1</a></p>
<h2 id="React的四个概念简单介绍"><a href="#React的四个概念简单介绍" class="headerlink" title="React的四个概念简单介绍"></a>React的四个概念简单介绍</h2><p>React主要有四个主要概念构成：</p>
<blockquote>
<p>Virtual DOM<br>React 组件<br>JSX语法<br>Data Flow（单向数据流）</p>
</blockquote>
<h3 id="Virtual-DOM"><a href="#Virtual-DOM" class="headerlink" title="Virtual DOM"></a>Virtual DOM</h3><h4 id="虚拟DOM是React的基石"><a href="#虚拟DOM是React的基石" class="headerlink" title="虚拟DOM是React的基石"></a>虚拟DOM是React的基石</h4><p>之所以引入虚拟 DOM，一方面是性能的考虑。Web 应用和网站不同，一个 Web 应用 中通常会在单页内有大量的 DOM 操作，而这些DOM操作很慢。</p>
<p>在 React 中，应用程序在虚拟 DOM 上操作，这让 React 有了优化的机会。简单说，React 在每次需要渲染时，会先比较当前 DOM 内容和待渲染内容的差异，然后再决定如何最优地更新 DOM。这个过程被称为 reconciliation。</p>
<p>除了性能的考虑，React 引入虚拟 DOM 更重要的意义是提供了一种一致的开发方式来开发服务端应用、Web 应用和手机端应用：</p>
<p><img src="/images/React001.png" alt="虚拟DOM服务端应用、Web应用和手机端应用"></p>
<p>因为有了虚拟 DOM 这一层，所以通过配备不同的渲染器，就可以将虚拟 DOM 的内容渲染到不同的平台。而应用开发者，使用 JavaScript 就可以通吃各个平台了。</p>
<h4 id="Virtual-DOM速度快的说明"><a href="#Virtual-DOM速度快的说明" class="headerlink" title="Virtual DOM速度快的说明"></a>Virtual DOM速度快的说明</h4><p>在 Web 开发中，我们总需要将变化的数据实时反应到 UI 上，这时就需要对 DOM 进行操作。而复杂或频繁的 DOM 操作通常是性能瓶颈产生的原因（如何进行高性能的复杂 DOM 操作通常是衡量一个前端开发人员技能的重要指标）。</p>
<p>React 为此引入了虚拟 DOM（Virtual DOM）的机制：在浏览器端用 Javascript 实现了一套 DOM API。基于 React 进行开发时所有的 DOM 构造都是通过虚拟 DOM 进行，每当数据变化时，React 都会重新构建整个 DOM 树，然后 React 将当前整个 DOM 树和上一次的 DOM 树进行对比，得到 DOM 结构的区别。而且 React 能够批处理虚拟 DOM 的刷新，在一个事件循环（Event Loop）内的两次数据变化会被合并。例如连续的先将节点内容从 A 变成 B，然后又从 B 变成 A，React 会认为 UI 不发生任何变化，而如果通过手动控制，这种逻辑通常是极其复杂的。</p>
<p>尽管每一次都需要构造完整的虚拟 DOM 树，但是因为虚拟 DOM 是内存数据，性能是极高的。而对实际 DOM 进行操作的仅仅是 Diff 部分，因而能达到提高性能的目的。这样，在保证性能的同时，开发者将不再需要关注某个数据的变化如何更新到一个或多个具体的 DOM 元素，而只需要 关心在任意一个数据状态下，整个界面是如何 Render 的。</p>
<p><a href="http://blog.csdn.net/yczz/article/details/49585313" target="_blank" rel="noopener">http://blog.csdn.net/yczz/article/details/49585313</a></p>
<h3 id="React组件"><a href="#React组件" class="headerlink" title="React组件"></a>React组件</h3><h4 id="组件化概念"><a href="#组件化概念" class="headerlink" title="组件化概念"></a>组件化概念</h4><blockquote>
<p>虚拟 DOM(virtual-dom) 不仅带来了简单的 UI 开发逻辑，同时也带来了组件化开发的思想。<br>所谓组件，即封装起来的具有独立功能的UI部件。</p>
</blockquote>
<p>React 推荐以组件的方式去重新思考 UI 构成，将 UI 上每一个功能相对独立的模块定义成组件，然后将小的组件通过组合或者嵌套的方式构成大的组件，最终完成整体UI的构建。<br>例如，Facebook 的 instagram.com 整站都采用了 React 来开发，整个页面就是一个大的组件，其中包含了嵌套的大量其它组件。</p>
<blockquote>
<p>如果说 MVC 的思想是做到视图-数据-控制器的分离，那么组件化的思考方式则是带来了 UI 功能模块之间的分离。</p>
</blockquote>
<p>通过一个典型的 Blog 评论界面来看 MVC 和组件化开发思路的区别：</p>
<p>对于 MVC 开发模式来说，开发者将三者定义成不同的类，实现了表现，数据，控制的分离。开发者更多的是从技术的角度来对UI进行拆分，实现松耦合。</p>
<p>对于 React 而言，则完全是一个新的思路，开发者从功能的角度出发，将 UI 分成不同的组件，每个组件都独立封装。在 React 中，按照界面模块自然划分的方式来组织和编写代码，</p>
<p>对于评论界面而言，整个 UI 是一个通过小组件构成的大组件，每个组件只关心自己部分的逻辑，彼此独立。</p>
<p><img src="/images/React002.png" alt="组件的特点"></p>
<h4 id="组件化开发特性"><a href="#组件化开发特性" class="headerlink" title="组件化开发特性"></a>组件化开发特性</h4><p>React认为一个组件应该具有如下特征：</p>
<blockquote>
<p>(1)、可组合（Composeable）：一个组件易于和其它组件一起使用，或者嵌套在另一个组件内部。如果一个组件内部创建了另一个组件，那么说父组件拥有（own）它创建的子组件，通过这个特性，一个复杂的UI可以拆分成多个简单的UI组件；<br>(2)、可重用（Reusable）：每个组件都是具有独立功能的，它可以被使用在多个UI场景；<br>(3)、可维护（Maintainable）：每个小的组件仅仅包含自身的逻辑，更容易被理解和维护；<br>(4)、可测试（Testable）：因为每个组件都是独立的，那么对于各个组件分别测试显然要比对于整个UI进行测试容易的多。</p>
</blockquote>
<h4 id="组件定义"><a href="#组件定义" class="headerlink" title="组件定义"></a>组件定义</h4><p>在 React 中定义一个组件也是相当的容易，组件就是一个实现预定义接口的 JavaScript 类：</p>
<blockquote>
<p>1、组件渲染</p>
</blockquote>
<p>ReactDOM.render 是 React 的最基本方法，用于将模板转为 HTML 语言，并插入指定的 DOM 节点。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;h1&gt;Hello, world!<span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'example'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>而这个方法， 必须而且只能返回一个有效的 React 元素。这意味着，如果你的组件是由多个元素构成的，那么你必须在外边包一个顶层元素，然后返回这个顶层元素。比如创建一个布局组件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">render:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> React.createElement(</span><br><span class="line">        <span class="string">"div"</span>,<span class="literal">null</span>,</span><br><span class="line">        React.createElement(<span class="string">"div"</span>,<span class="literal">null</span>,<span class="string">"header"</span>),</span><br><span class="line">        React.createElement(<span class="string">"div"</span>,<span class="literal">null</span>,<span class="string">"content"</span>),</span><br><span class="line">        React.createElement(<span class="string">"div"</span>,<span class="literal">null</span>,<span class="string">"footer"</span>)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2、ES5方式定义组件</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="keyword">var</span> HelloMessage = React.createClass(&#123;</span><br><span class="line">      displayName: <span class="string">"HelloMessage"</span>,</span><br><span class="line">      render: <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> React.createElement(</span><br><span class="line">                  <span class="string">"div"</span>,</span><br><span class="line">                  <span class="literal">null</span>,</span><br><span class="line">                  <span class="string">"Hello "</span>,</span><br><span class="line">                  <span class="keyword">this</span>.props.name</span><br><span class="line">            );</span><br><span class="line">      &#125;</span><br><span class="line">&#125;);</span><br><span class="line">ReactDOM.render(React.createElement(HelloMessage, &#123; <span class="attr">name</span>: <span class="string">"John"</span> &#125;), mountNode);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>3、JSX 中定义组件</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> HelloMessage = React.createClass(&#123;</span><br><span class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">HelloMessage</span> <span class="attr">name</span>=<span class="string">"John"</span> /&gt;</span>, mountNode);</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>4、ES6中定义组件</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'./Hello.css'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./Hello.scss'</span>;</span><br><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="comment">// 内联样式</span></span><br><span class="line"><span class="keyword">let</span> style = &#123;</span><br><span class="line">    backgroundColor:<span class="string">'blue'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state = &#123; <span class="attr">count</span>: <span class="string">'es6'</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;h1 style=&#123;style&#125;&gt;Hello world&#123;<span class="keyword">this</span>.state.count&#125;&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">                &lt;br/</span>&gt;</span><br><span class="line">                &lt;image/&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>5、注意事项</p>
</blockquote>
<p>React 组件名称的首字母应当大写，关于大小写的差异你会在后面发现。</p>
<p>div 元素的样式类是用 className 而不是 class 声明的，这是因为 class 是 JavaScript 的保留字，渲染后，真实的 DOM 还会是：<code>&lt;div class=&quot;ez-led&quot;&gt;Hello, React!&lt;/div&gt;</code></p>
<h3 id="JSX语法"><a href="#JSX语法" class="headerlink" title="JSX语法"></a>JSX语法</h3><blockquote>
<p>什么是 JSX</p>
</blockquote>
<p>在用 React 写组件的时候，通常会用到 JSX 语法，像是在 Javascript 代码里直接写起了 XML 标签，每一个 XML 标签都会被 JSX 转换工具转换成纯 Javascript 代码，直接使用纯 Javascript 代码写也是可以的，只是利用 JSX，组件的结构和组件之间的关系看上去更加清晰</p>
<blockquote>
<p>JSX 语法使用</p>
</blockquote>
<p>HTML 语言直接写在 JavaScript 语言之中，不加任何引号，这就是 JSX 的语法，它允许 HTML 与 JavaScript 的混写。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> names = [<span class="string">'Alice'</span>, <span class="string">'Emily'</span>, <span class="string">'Kate'</span>];</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    names.map(<span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span> Hello, &#123;name&#125;! <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;,</span></span><br><span class="line"><span class="regexp">  document.getElementById('example')</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>
<p>上面代码体现了 JSX 的基本语法规则：遇到 HTML 标签（以 <code>&lt;</code> 开头），就用 HTML 规则解析；遇到代码块（以 <code>{</code> 开头），就用 JavaScript 规则解析。</p>
<p>JSX 允许直接在模板插入 JavaScript 变量。如果这个变量是一个数组，则会展开这个数组的所有成员</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [</span><br><span class="line">  &lt;h1&gt;Hello world!<span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>,</span><br><span class="line">  &lt;h2&gt;React is awesome&lt;<span class="regexp">/h2&gt;,</span></span><br><span class="line"><span class="regexp">];</span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">  &lt;div&gt;&#123;arr&#125;&lt;/</span>div&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'example'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>上面代码的 arr 变量是一个数组，结果 JSX 会把它的所有成员，添加到模板，运行结果如下:</p>
<p><img src="/images/React003.png" alt="运行结果"></p>
<h3 id="Data-Flow（单向数据流）"><a href="#Data-Flow（单向数据流）" class="headerlink" title="Data Flow（单向数据流）"></a>Data Flow（单向数据流）</h3><h4 id="传统的-MVC"><a href="#传统的-MVC" class="headerlink" title="传统的 MVC"></a>传统的 MVC</h4><p><img src="/images/React004.png" alt="传统的MVC"></p>
<p>到了 Flux 当中, 除了名字改变了, 重要的是大量的 Model 归到了 Store, View 也统一了,从而得到了所谓单向的数据流, 就是 Model 和 View 之间关系非常清晰了。这样需要人为管理的状态就一下少了很多, 结果体现在开发应用的效率当中。</p>
<h4 id="Flux"><a href="#Flux" class="headerlink" title="Flux"></a>Flux</h4><p>1、学习地址：<a href="https://hulufei.gitbooks.io/react-tutorial/content/flux.html" target="_blank" rel="noopener">https://hulufei.gitbooks.io/react-tutorial/content/flux.html</a></p>
<p>2、React 标榜自己是 MVC 里面 V 的部分，那么 Flux 就相当于添加 M 和 C 的部分，Flux 是 Facebook 使用的一套前端应用的架构模式。</p>
<p>3、一个 Flux 应用主要包含四个部分：</p>
<p>(1)、dispatcher 处理动作分发，维护 Store 之间的依赖关系</p>
<p>(2)、stores 数据和逻辑部分</p>
<p>(3)、views React 组件，这一层可以看作 controller-views，作为视图同时响应用户交互</p>
<p>(4)、actions 提供给 dispatcher 传递数据给 store</p>
<h4 id="Flux-的核心“单向数据流“怎么运作的："><a href="#Flux-的核心“单向数据流“怎么运作的：" class="headerlink" title="Flux 的核心“单向数据流“怎么运作的："></a>Flux 的核心“单向数据流“怎么运作的：</h4><p><code>Action -&gt; Dispatcher -&gt; Store -&gt; View</code></p>
<p>更多时候 View 会通过用户交互触发 Action，所以一个简单完整的数据流类似这样：</p>
<p><img src="/images/React005.png" alt="一个简单完整的数据流"></p>
<p>整个流程如下：</p>
<blockquote>
<p>首先要有 action，通过定义一些 action creator 方法根据需要创建 Action 提供给 dispatcher<br>View 层通过用户交互（比如 onClick）会触发 Action<br>Dispatcher 会分发触发的 Action 给所有注册的 Store 的回调函数<br>Store 回调函数根据接收的 Action 更新自身数据之后会触发一个 change 事件通知 View 数据更改了<br>View 会监听这个 change 事件，拿到对应的新数据并调用 setState 更新组件 UI</p>
</blockquote>
<p>所有的状态都由 Store 来维护，通过 Action 传递数据，构成了如上所述的单向数据流循环，所以应用中的各部分分工就相当明确，高度解耦了。这种单向数据流使得整个系统都是透明可预测的。</p>
<h4 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h4><p>Redux 官方中文文档：<a href="http://camsong.github.io/redux-in-chinese/index" target="_blank" rel="noopener">http://camsong.github.io/redux-in-chinese/index</a>.</p>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><p>Reflux：<a href="https://segmentfault.com/a/1190000002793786?utm_source=tuicool" target="_blank" rel="noopener">https://segmentfault.com/a/1190000002793786?utm_source=tuicool</a></p>
<h2 id="React快速开始"><a href="#React快速开始" class="headerlink" title="React快速开始"></a>React快速开始</h2><h3 id="创建项目文件夹"><a href="#创建项目文件夹" class="headerlink" title="创建项目文件夹"></a>创建项目文件夹</h3><p>初始化npm配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm init -y</span><br></pre></td></tr></table></figure>
<h3 id="依赖环境"><a href="#依赖环境" class="headerlink" title="依赖环境"></a>依赖环境</h3><p>在项目根目录下打开命令窗口下载 react 和 react-dom 依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install  react  react-dom --save</span><br></pre></td></tr></table></figure>
<h3 id="创建目录结构"><a href="#创建目录结构" class="headerlink" title="创建目录结构"></a>创建目录结构</h3><p>Hello World</p>
<p>英文官网的：<a href="http://facebook.github.io/react/index.html" target="_blank" rel="noopener">http://facebook.github.io/react/index.html</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Var React = <span class="built_in">require</span>(<span class="string">'react'</span>);</span><br><span class="line">Var ReactDOM = <span class="built_in">require</span>(<span class="string">'react-dom'</span>);</span><br><span class="line"><span class="keyword">var</span> HelloMessage = React.createClass(&#123;</span><br><span class="line">    render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">HelloMessage</span> <span class="attr">name</span>=<span class="string">"John"</span> /&gt;</span>, mountNode);</span></span><br></pre></td></tr></table></figure>
<h3 id="代码编译方式（语法转换）"><a href="#代码编译方式（语法转换）" class="headerlink" title="代码编译方式（语法转换）"></a>代码编译方式（语法转换）</h3><p>因为现在都是使用 jsx 和 es6，所以我们需要对 js 代码进行编译。</p>
<p>编译转换有分为浏览器中转换和离线转换，但是基本上不会用在浏览器中引入转换 js 转换，所以只介绍离线转换。</p>
<h4 id="react-tools转换"><a href="#react-tools转换" class="headerlink" title="react-tools转换"></a>react-tools转换</h4><p>这是 react 自己提供的，而且是老版本的，因为中文官网还是老版本的 api，所以介绍的是这种方式。</p>
<blockquote>
<p>首先安装依赖<br>用命令进行转换，有兴趣的大家自己看一下jsx -h</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g react-tools</span><br><span class="line">jsx  --watch  src/  build/</span><br></pre></td></tr></table></figure>
<p>参考地址：<a href="http://reactjs.cn/react/docs/getting-started.html" target="_blank" rel="noopener">http://reactjs.cn/react/docs/getting-started.html</a></p>
<h4 id="babel转换"><a href="#babel转换" class="headerlink" title="babel转换"></a>babel转换</h4><p>英文官网的文档比较新，已经推荐使用 babel 来进行转换</p>
<blockquote>
<p>1、下载依赖</p>
</blockquote>
<p>安装babel、babel转换jsx的包、babel转化ES6的包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install --global babel-cli</span><br><span class="line">npm install babel-preset-react  -dev-save</span><br><span class="line">npm install babel-preset-es2015 -dev-save</span><br></pre></td></tr></table></figure>
<p>注意:加了 -dev 之后，运行 npm install 不会下载开发依赖，需要运行 npm install –dev</p>
<blockquote>
<p>2、运行命令进行编译</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">babel --presets react src --watch --out-dir build</span><br></pre></td></tr></table></figure>
<blockquote>
<p>3、将编译之后的js文件在index.html文件中引入</p>
</blockquote>
<h4 id="Gulp-react"><a href="#Gulp-react" class="headerlink" title="Gulp-react"></a>Gulp-react</h4><p><a href="https://github.com/sindresorhus/gulp-react" target="_blank" rel="noopener">https://github.com/sindresorhus/gulp-react</a></p>
<h4 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h4><p>请查看 webpack 的文档</p>
<h4 id="开发工具"><a href="#开发工具" class="headerlink" title="开发工具"></a>开发工具</h4><p><img src="/images/React006.png" alt="开发工具"></p>
<h2 id="主要知识"><a href="#主要知识" class="headerlink" title="主要知识"></a>主要知识</h2><h3 id="视图相关概念"><a href="#视图相关概念" class="headerlink" title="视图相关概念 !!!"></a>视图相关概念 !!!</h3><blockquote>
<p>Props（属性，就是 element 上的 attrss）<br>State（写过 view 组件的基本都会知道，按钮有三态，Normal，Highlight，Selected，包括 extjs，jquery 里的大部分 ui 框架都是有状态的。）<br>Event（其实还应该算一个就是 dom 事件）</p>
</blockquote>
<p>了解了上面这些，就可以写代码了，因为:</p>
<blockquote>
<p>属性，解决了view的定义问题，即语义描述<br>状态，是view的有穷状态机，根据状态决定组件 ui 和行为<br>事件，是view里元素的行为</p>
</blockquote>
<p>有穷状态机：<a href="http://baike.baidu.com/view/115336.htm" target="_blank" rel="noopener">http://baike.baidu.com/view/115336.htm</a></p>
<h3 id="jsx语法详解"><a href="#jsx语法详解" class="headerlink" title="jsx语法详解"></a>jsx语法详解</h3><h4 id="HTML-转义"><a href="#HTML-转义" class="headerlink" title="HTML 转义"></a>HTML 转义</h4><p>React 会将所有要显示到 DOM 的字符串转义，防止 XSS。<br>所以如果 JSX 中含有转义后的实体字符比如 © (<code>©</code>) 最后显示到 DOM 中不会正确显示，因为 React 自动把 © 中的特殊字符转义了。<br>有几种解决办法：</p>
<ul>
<li>直接使用 UTF-8 字符 <code>©</code></li>
<li>使用对应字符的 Unicode 编码</li>
<li>使用数组组装 <code>&lt;div&gt;{[&#39;cc &#39;, &lt;span&gt;&amp;copy;&lt;/span&gt;, &#39; 2015&#39;]}&lt;/div&gt;</code></li>
<li>直接插入原始的 HTML</li>
</ul>
<p><code>&lt;div dangerouslySetInnerHTML=\{\{__html: &#39;cc &amp;copy; 2015&#39;\}\} /&gt;</code></p>
<p>dangerouslySetInnerHTML 参考文档: <a href="http://reactjs.cn/react/tips/dangerously-set-inner-html.html" target="_blank" rel="noopener">http://reactjs.cn/react/tips/dangerously-set-inner-html.html</a></p>
<h4 id="自定义-HTML-属性"><a href="#自定义-HTML-属性" class="headerlink" title="自定义 HTML 属性"></a>自定义 HTML 属性</h4><p>如果在 JSX 中使用的属性不存在于 HTML 的规范中，这个属性会被忽略。如果要使用自定义属性，可以用 data- 前缀。可访问性属性的前缀 aria- 也是支持的。</p>
<p>与dom的区别文档：<a href="http://reactjs.cn/react/docs/dom-differences.html" target="_blank" rel="noopener">http://reactjs.cn/react/docs/dom-differences.html</a></p>
<h4 id="支持的标签和属性"><a href="#支持的标签和属性" class="headerlink" title="支持的标签和属性"></a>支持的标签和属性</h4><p>如果你要使用的某些标签或属性不在这些支持列表里面就可能被 React 忽略，必须要使用的话可以提 issue，或者用前面提到的 dangerouslySetInnerHTML。</p>
<p>支持列表：<a href="http://reactjs.cn/react/docs/tags-and-attributes.html" target="_blank" rel="noopener">http://reactjs.cn/react/docs/tags-and-attributes.html</a></p>
<p>1、并不是所有的 html 标签和属性都能在 jsx 语法中使用</p>
<p>2、基本上你能用到的标签的属性，jsx 语法都支持</p>
<p>3、有些特殊的属性需要注意，必须 class 属性要变为 className 属性</p>
<p>所有的属性都是驼峰命名的，class 属性和 for 属性分别改为 className 和 htmlFor，来符合 DOM API 规范。</p>
<h4 id="属性扩散"><a href="#属性扩散" class="headerlink" title="属性扩散"></a>属性扩散</h4><p>有时候你需要给组件设置多个属性，你不想一个个写下这些属性，或者有时候你甚至不知道这些属性的名称，这时候 spread attributes 的功能就很有用了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> props = &#123;&#125;;</span><br><span class="line">props.foo = x;</span><br><span class="line">props.bar = y;</span><br><span class="line"><span class="keyword">var</span> component = <span class="xml"><span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span>;</span></span><br></pre></td></tr></table></figure>
<p>属性也可以被覆盖，写在后面的属性值会覆盖前面的属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> props = &#123; <span class="attr">foo</span>: <span class="string">'default'</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> component = <span class="xml"><span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">foo</span>=<span class="string">&#123;</span>'<span class="attr">override</span>'&#125; /&gt;</span>;</span></span><br><span class="line"><span class="xml">console.log(component.props.foo); // 'override'</span></span><br></pre></td></tr></table></figure>
<h4 id="自闭合标签"><a href="#自闭合标签" class="headerlink" title="自闭合标签"></a>自闭合标签</h4><p>如果只有一个组件，就用单闭合标签形式，如果有多个组件嵌套就用双闭合标签形式</p>
<p><a href="http://reactjs.cn/react/tips/self-closing-tag.html" target="_blank" rel="noopener">http://reactjs.cn/react/tips/self-closing-tag.html</a></p>
<h4 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h4><p>在 JSX 里使用注释也很简单，就是沿用 JavaScript，唯一要注意的是在一个组件的子元素位置使用注释要用 <code>{}</code> 包起来</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> content = (</span><br><span class="line">     &lt;Nav&gt;</span><br><span class="line">          &#123;<span class="comment">/* child comment, put &#123;&#125; around */</span>&#125;</span><br><span class="line">          &lt;Person</span><br><span class="line">               <span class="comment">/* multi</span></span><br><span class="line"><span class="comment">                   line</span></span><br><span class="line"><span class="comment">                   comment */</span></span><br><span class="line">               name=&#123;<span class="built_in">window</span>.isLoggedIn ? <span class="built_in">window</span>.name : <span class="string">''</span>&#125; <span class="comment">// end of line comment</span></span><br><span class="line">          /&gt;</span><br><span class="line">     &lt;<span class="regexp">/Nav&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>
<h2 id="React-的-API"><a href="#React-的-API" class="headerlink" title="React 的 API"></a>React 的 API</h2><h3 id="顶层-API"><a href="#顶层-API" class="headerlink" title="顶层 API"></a>顶层 API</h3><p><a href="http://facebook.github.io/react/docs/top-level-api.html" target="_blank" rel="noopener">http://facebook.github.io/react/docs/top-level-api.html</a></p>
<h3 id="组件-API"><a href="#组件-API" class="headerlink" title="组件 API"></a>组件 API</h3><p><a href="http://facebook.github.io/react/docs/component-api.html" target="_blank" rel="noopener">http://facebook.github.io/react/docs/component-api.html</a></p>
<h3 id="组件的生命周期（特别重要）"><a href="#组件的生命周期（特别重要）" class="headerlink" title="组件的生命周期（特别重要）"></a>组件的生命周期（特别重要）</h3><p>组件的生命周期，另外的名字是状态回调，和上面讲的状态的唯一差别，上面的状态是它里面的元素，而组件的生命周期是它自己。</p>
<p><a href="https://hulufei.gitbooks.io/react-tutorial/content/component-lifecycle.html" target="_blank" rel="noopener">https://hulufei.gitbooks.io/react-tutorial/content/component-lifecycle.html</a></p>
<h4 id="组件的生命周期分成三个状态："><a href="#组件的生命周期分成三个状态：" class="headerlink" title="组件的生命周期分成三个状态："></a>组件的生命周期分成三个状态：</h4><blockquote>
<p>Mounting：已插入真实 DOM<br>Updating：正在被重新渲染<br>Unmounting：已移出真实 DOM</p>
</blockquote>
<h4 id="处理函数"><a href="#处理函数" class="headerlink" title="处理函数"></a>处理函数</h4><p>React 为每个状态都提供了两种处理函数，will函数在进入状态之前调用，did 函数在进入状态之后调用，三种状态共计五种处理函数。</p>
<blockquote>
<p>componentWillMount()<br>componentDidMount()<br>componentWillUpdate(object nextProps, object nextState)<br>componentDidUpdate(object prevProps, object prevState)<br>componentWillUnmount()</p>
</blockquote>
<p>此外，React 还提供两种特殊状态的处理函数。</p>
<blockquote>
<p>componentWillReceiveProps(object nextProps)：已加载组件收到新的参数时调用<br>shouldComponentUpdate(object nextProps, object nextState)：组件判断是否重新渲染时调用</p>
</blockquote>
<h4 id="函数调用顺序图"><a href="#函数调用顺序图" class="headerlink" title="函数调用顺序图"></a>函数调用顺序图</h4><p><img src="/images/React007.png" alt="函数调用顺序图"></p>
<p>从上图中我们可以看出来，组件再初始化一次之后就不会再运行上图运行中文字以上的方法，反而里面会有事件监听，从而执行 shouleComponentUpdate 事件。</p>
<h4 id="代码使用"><a href="#代码使用" class="headerlink" title="代码使用"></a>代码使用</h4><blockquote>
<p>ES5写法</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Hello = React.createClass(&#123;</span><br><span class="line">    getInitialState() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">liked</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.liked);</span><br><span class="line">        <span class="keyword">return</span>(</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;h1 style=&#123;style&#125;&gt;Hello world&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">                &lt;br/</span>&gt;</span><br><span class="line">                &lt;image/&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br><span class="line"><span class="regexp">module.exports = Hello;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>ES6写法</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state = &#123; <span class="attr">count</span>: <span class="string">'es6'</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;h1 style=&#123;style&#125;&gt;Hello world&#123;<span class="keyword">this</span>.state.count&#125;&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">                &lt;br/</span>&gt;</span><br><span class="line">                &lt;image/&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h4><p><a href="http://www.cnblogs.com/CHONGCHONG2008/p/5099483.html" target="_blank" rel="noopener">http://www.cnblogs.com/CHONGCHONG2008/p/5099483.html</a><br><a href="http://pinggod.com/2015/React-%E7%BB%84%E4%BB%B6%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/" target="_blank" rel="noopener">http://pinggod.com/2015/React-%E7%BB%84%E4%BB%B6%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</a><br><a href="http://reactjs.cn/react/docs/component-specs.html" target="_blank" rel="noopener">http://reactjs.cn/react/docs/component-specs.html</a></p>
<h4 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h4><p>在 ES6 中用 ES5 的写法会报错.</p>
<h4 id="ES5-ES6-最新写法对照表"><a href="#ES5-ES6-最新写法对照表" class="headerlink" title="ES5/ES6 最新写法对照表"></a>ES5/ES6 最新写法对照表</h4><p>React 的：</p>
<p><a href="http://www.tuicool.com/articles/equ2my" target="_blank" rel="noopener">http://www.tuicool.com/articles/equ2my</a></p>
<p>ReactNative 的:</p>
<p><a href="http://bbs.reactnative.cn/topic/15/react-react-native-%E7%9A%84es5-es6%E5%86%99%E6%B3%95%E5%AF%B9%E7%85%A7%E8%A1%A8/2" target="_blank" rel="noopener">http://bbs.reactnative.cn/topic/15/react-react-native-%E7%9A%84es5-es6%E5%86%99%E6%B3%95%E5%AF%B9%E7%85%A7%E8%A1%A8/2</a></p>
<h4 id="生命周期代码-ES5-和-ES6-的区别"><a href="#生命周期代码-ES5-和-ES6-的区别" class="headerlink" title="生命周期代码 ES5 和 ES6 的区别"></a>生命周期代码 ES5 和 ES6 的区别</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//语法规定</span></span><br><span class="line"><span class="comment">//1、定义模块 class Life extends Component</span></span><br><span class="line"><span class="comment">//2、导出模块 export default</span></span><br><span class="line"><span class="comment">//3、引入模块 import</span></span><br><span class="line"><span class="comment">//4、默认属性</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">static defaultProps = &#123;</span></span><br><span class="line"><span class="comment">autoPlay: false,</span></span><br><span class="line"><span class="comment">    maxLoops: 10,</span></span><br><span class="line"><span class="comment">&#125;;  // 注意这里有分号</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//5、默认state</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> constructor(props)&#123;</span></span><br><span class="line"><span class="comment">     super(props);</span></span><br><span class="line"><span class="comment">     console.log("构造函数");</span></span><br><span class="line"><span class="comment">     // 初始化了我们的state，这是被推荐的写法</span></span><br><span class="line"><span class="comment">     this.state = &#123;</span></span><br><span class="line"><span class="comment">        props1:"初始化state"</span></span><br><span class="line"><span class="comment">     &#125;;</span></span><br><span class="line"><span class="comment"> &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//6、定义方法</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">（1）生命周期的方法</span></span><br><span class="line"><span class="comment"> componentWillMount()&#123;</span></span><br><span class="line"><span class="comment">    console.log("componentWillMount");</span></span><br><span class="line"><span class="comment"> &#125;</span></span><br><span class="line"><span class="comment"> (2)自定义的方法</span></span><br><span class="line"><span class="comment"> click1=()=&gt;&#123;</span></span><br><span class="line"><span class="comment">     console.log("点击了单击事件");</span></span><br><span class="line"><span class="comment">     this.setState(&#123;</span></span><br><span class="line"><span class="comment">         props1:"改变state的值"</span></span><br><span class="line"><span class="comment">     &#125;)</span></span><br><span class="line"><span class="comment">     console.log("点击了单击事件结束");</span></span><br><span class="line"><span class="comment"> &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// ES6语法定义的组件生命周期</span></span><br><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Life</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="comment">// getDefaultProps,getInitialState在es6的写法中不被支持</span></span><br><span class="line">    <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"构造函数"</span>);</span><br><span class="line">        <span class="comment">// 初始化了我们的state，这是被推荐的写法</span></span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">           props1: <span class="string">"初始化state"</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 组件将要被渲染到真实的dom节点中</span></span><br><span class="line">    componentWillMount()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"componentWillMount"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 组件已经插入到真实的dom节点中</span></span><br><span class="line">    componentDidMount()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"componentDidMount"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 组件是否要被重新渲染</span></span><br><span class="line">    shouldComponentUpdate()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"shouldCompontentUpdate"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 组件将要被重新渲染</span></span><br><span class="line">    componentWillUpdate()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"conpontentWillUpdate"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 组件已经被重新渲染</span></span><br><span class="line">    componentDidUpdate()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"conpontentDidUpdate"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 组件将要接受到新属性</span></span><br><span class="line">    componentWillReceiveProps()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"compintentWillReceiveProps"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    click1 = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"点击了单击事件"</span>);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            props1:<span class="string">"改变state的值"</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"点击了单击事件结束"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"render"</span>);</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;h1 onClick=&#123;<span class="keyword">this</span>.click1&#125;&gt;&#123;<span class="keyword">this</span>.state.props1&#125;&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ES5定义组件的写法</span></span><br><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">var</span> Life = React.createClass(&#123;</span><br><span class="line">   <span class="comment">// getDefaultProps,getInitialState在es6的写法中不被支持</span></span><br><span class="line">   <span class="comment">// 初始化props属性方法</span></span><br><span class="line">   getDefaultProps()&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"getDefaultProps"</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">// 初始化我们的state属性</span></span><br><span class="line">   getInitialState()&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"getInitialState"</span>);</span><br><span class="line">       <span class="keyword">return</span> &#123;</span><br><span class="line">           props1: <span class="string">"初始化state的值"</span></span><br><span class="line">       &#125;</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">// 组件将要被渲染到真实的dom节点中</span></span><br><span class="line">   componentWillMount()&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"componentWillMount"</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">// 组件已经插入到真实的dom节点中</span></span><br><span class="line">   componentDidMount()&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"componentDidMount"</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">// 组件是否要被重新渲染</span></span><br><span class="line">   shouldComponentUpdate()&#123;</span><br><span class="line">       <span class="comment">// 这个方法比较特殊，如果你要重写，你要在这里手动的进行一下state值是否发生改变的判断，因为已经把之前的方法覆盖了</span></span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"shouldCompontentUpdate"</span>);</span><br><span class="line">       <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">// 组件将要被重新渲染</span></span><br><span class="line">   componentWillUpdate()&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"conpontentWillUpdate"</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">// 组件已经被重新渲染</span></span><br><span class="line">   componentDidUpdate()&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"conpontentDidUpdate"</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">// 组件将要接受到新属性</span></span><br><span class="line">   componentWillReceiveProps()&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"compintentWillReceiveProps"</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   click1()&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"点击事件"</span>);</span><br><span class="line">       <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">           props1:<span class="string">"改变state的值"</span></span><br><span class="line">       &#125;)</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"2"</span>);</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.props1);</span><br><span class="line">   &#125;,</span><br><span class="line">   render() &#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"render"</span>);</span><br><span class="line">       <span class="keyword">return</span> (</span><br><span class="line">           &lt;div&gt;</span><br><span class="line">               &lt;h1 onClick=&#123;<span class="keyword">this</span>.click1&#125;&gt;&#123;<span class="keyword">this</span>.state.props1&#125;&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">           &lt;/</span>div&gt;</span><br><span class="line">       )</span><br><span class="line">   &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">module</span>.exports = Life;</span><br></pre></td></tr></table></figure>
<h3 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h3><h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><p>onClick这种进行驼峰命名ES5和ES6的写法不一样，在ES6中要用bind方法绑定this(具体可参照ES5和ES6写法对照表)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkButton</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;<span class="attr">liked</span>: <span class="literal">false</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    handleClick(e) &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123; <span class="attr">liked</span>: !<span class="keyword">this</span>.state.liked &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> text = <span class="keyword">this</span>.state.liked ? <span class="string">'like'</span> : <span class="string">'haven\'t liked'</span>;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;p onClick=&#123;<span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>)&#125;&gt;</span><br><span class="line">                You &#123;text&#125; <span class="keyword">this</span>. Click to toggle.</span><br><span class="line">            &lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="参数传递"><a href="#参数传递" class="headerlink" title="参数传递"></a>参数传递</h4><p>ES6 写法：给事件处理函数传递额外参数的方式：bind(this, arg1, arg2, …)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick.bind(this,</span> <span class="attr">param1</span>, <span class="attr">param2</span>, <span class="attr">param3</span>)&#125;&gt;</span>;</span></span><br><span class="line"><span class="xml">&#125;,</span></span><br><span class="line"><span class="xml">handleClick: function(param1,param2,param3, event) &#123;</span></span><br><span class="line"><span class="xml">    // handle click</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="React-支持的事件列表"><a href="#React-支持的事件列表" class="headerlink" title="React 支持的事件列表"></a>React 支持的事件列表</h4><p><a href="http://reactjs.cn/react/docs/events.html" target="_blank" rel="noopener">http://reactjs.cn/react/docs/events.html</a></p>
<p>组件事件的一个例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// react中的事件支持和使用</span></span><br><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="comment">// 直接在js中定义样式，内嵌样式</span></span><br><span class="line"><span class="keyword">let</span> style = &#123;</span><br><span class="line">    backgroundColor: <span class="string">'blue'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">ClickEvent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 设置默认属性和默认状态</span></span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="comment">// 初始化state</span></span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            liked: <span class="literal">false</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 单击事件处理方法</span></span><br><span class="line">    handleClick(pm1,pm2,pm3,e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(pm1);</span><br><span class="line">        <span class="built_in">console</span>.log(pm2);</span><br><span class="line">        <span class="built_in">console</span>.log(pm3);</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123; <span class="attr">liked</span>: !<span class="keyword">this</span>.state.liked &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 用箭头函数去定义自己的方法</span></span><br><span class="line">    handleMouseOver=<span class="function">(<span class="params">str</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(str);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> text = <span class="keyword">this</span>.state.liked ? <span class="string">'like'</span> : <span class="string">'haven\'t liked'</span>;</span><br><span class="line">        <span class="comment">// return；里面是要渲染的html页面</span></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;p onMouseOver=&#123;()=&gt;<span class="keyword">this</span>.handleMouseOver(<span class="string">"2016年"</span>)&#125; onClick=&#123;<span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>,<span class="number">12</span>,<span class="string">"dfdf"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;)&#125;&gt;</span><br><span class="line">                You &#123;text&#125; <span class="keyword">this</span>. Click to toggle.</span><br><span class="line">            &lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Dom操作"><a href="#Dom操作" class="headerlink" title="Dom操作"></a>Dom操作</h3><h4 id="方法一：findDOMNode-方法"><a href="#方法一：findDOMNode-方法" class="headerlink" title="方法一：findDOMNode()方法"></a>方法一：findDOMNode()方法</h4><p>首先我们要了解 ReactDOM.render 组件返回的是对组件的引用也就是组件实例（对于无状态状态组件来说返回 null），注意 JSX 返回的不是组件实例，它只是一个 ReactElement 对象。</p>
<p>当组件加载到页面上之后（mounted），你都可以通过 react-dom 提供的 findDOMNode() 方法拿到组件对应的 DOM 元素。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; findDOMNode &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="comment">// Inside Component class</span></span><br><span class="line">componentDidMound() &#123;</span><br><span class="line">  <span class="keyword">const</span> el = findDOMNode(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line">findDOMNode() 不能用在无状态组件上。</span><br></pre></td></tr></table></figure>
<h4 id="方法二：refs属性"><a href="#方法二：refs属性" class="headerlink" title="方法二：refs属性"></a>方法二：refs属性</h4><p>另外一种方式就是通过在要引用的 DOM 元素上面设置一个 ref 属性指定一个名称，然后通过 this.refs.name 来访问对应的 DOM 元素。</p>
<p>如果 ref 是设置在原生 HTML 元素上，它拿到的就是 DOM 元素，如果设置在自定义组件上，它拿到的就是组件实例，这时候就需要通过 findDOMNode 来拿到组件的 DOM 元素。</p>
<p>因为无状态组件没有实例，所以 ref 不能设置在无状态组件上，一般来说这没什么问题，因为无状态组件没有实例方法，不需要 ref 去拿实例调用相关的方法，但是如果想要拿无状态组件的 DOM 元素的时候，就需要用一个状态组件封装一层，然后通过 ref 和 findDOMNode 去获取。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInputFocus</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state = &#123; <span class="attr">userInput</span>: <span class="string">''</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    handleChange(e) &#123;</span><br><span class="line">        <span class="comment">// 1、通过ref和this.refs的配合使用可以在react中获取dom元素，dom元素上所有的属性方法都可以使用</span></span><br><span class="line">        <span class="comment">// 2、通过this.refs获取dom元素是有使用位置限制的,必须在componentDidMount方法里面或者之后的生命周期方法中使用</span></span><br><span class="line">        <span class="comment">// 3、react中是不推荐你用document.getElementById的方式去获取dom元素的</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.refs.theInput.value);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123; <span class="attr">userInput</span>: e.target.value &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    clearAndFocusInput() &#123;</span><br><span class="line">        <span class="comment">// 第一个参数是要重新赋值的state，第二个参数一个回调函数</span></span><br><span class="line">        <span class="keyword">this</span>.setState(&#123; <span class="attr">userInput</span>: <span class="string">''</span> &#125;, () =&gt; &#123;</span><br><span class="line">            <span class="keyword">this</span>.refs.theInput.focus();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;div onClick = &#123;<span class="keyword">this</span>.clearAndFocusInput.bind(<span class="keyword">this</span>)&#125;&gt;</span><br><span class="line">                    Click to Focus and Reset</span><br><span class="line">                &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">                &lt;input</span></span><br><span class="line"><span class="regexp">                    ref = "theInput"</span></span><br><span class="line"><span class="regexp">                    value = &#123;this.state.userInput&#125;</span></span><br><span class="line"><span class="regexp">                    onChange = &#123;this.handleChange.bind(this)&#125;</span></span><br><span class="line"><span class="regexp">                /</span>&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">MyInputFocus.defaultProps = &#123;</span></span><br><span class="line"><span class="regexp">    autoPlay:false,</span></span><br><span class="line"><span class="regexp">    maxLoops:10,</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">MyInputFocus.propTypes = &#123;</span></span><br><span class="line"><span class="regexp">    autoPlay: React.PropTypes.bool.isRequired,</span></span><br><span class="line"><span class="regexp">    maxLoops: React.PropTypes.number.isRequired,</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><blockquote>
<p>可以使用 ref 到的组件定义的任何公共方法，比如 this.refs.myTypeahead.reset()<br>Refs 是访问到组件内部 DOM 节点唯一可靠的方法<br>Refs 会自动销毁对子组件的引用（当子组件删除时）<br>不要在 render 或者 render 之前访问 refs<br>不要滥用 refs，比如只是用它来按照传统的方式操作界面 UI：找到 DOM -&gt; 更新 DOM</p>
</blockquote>
<h3 id="和其他库配合使用"><a href="#和其他库配合使用" class="headerlink" title="和其他库配合使用"></a>和其他库配合使用</h3><p><a href="http://reactjs.cn/react/tips/use-react-with-other-libraries.html" target="_blank" rel="noopener">http://reactjs.cn/react/tips/use-react-with-other-libraries.html</a></p>
<h3 id="组件的-DOM-事件监听"><a href="#组件的-DOM-事件监听" class="headerlink" title="组件的 DOM 事件监听"></a>组件的 DOM 事件监听</h3><p>这篇文章是讲如何给 DOM 元素绑定 React 未提供的事件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Box = React.createClass(&#123;</span><br><span class="line">      getInitialState: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="attr">windowWidth</span>: <span class="built_in">window</span>.innerWidth&#125;;</span><br><span class="line">      &#125;,</span><br><span class="line">      handleResize: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;<span class="attr">windowWidth</span>: <span class="built_in">window</span>.innerWidth&#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">      componentDidMount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">'resize'</span>, <span class="keyword">this</span>.handleResize);</span><br><span class="line">      &#125;,</span><br><span class="line">      componentWillUnmount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">window</span>.removeEventListener(<span class="string">'resize'</span>, <span class="keyword">this</span>.handleResize);</span><br><span class="line">      &#125;,</span><br><span class="line">      render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Current window width: &#123;this.state.windowWidth&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;);</span><br><span class="line">React.render(<span class="xml"><span class="tag">&lt;<span class="name">Box</span> /&gt;</span>, mountNode);</span></span><br></pre></td></tr></table></figure>
<p><a href="http://reactjs.cn/react/tips/dom-event-listeners.html" target="_blank" rel="noopener">http://reactjs.cn/react/tips/dom-event-listeners.html</a></p>
<p>1、注意添加dom事件的位置</p>
<p>2、在组件退出的时候，取消监听事件</p>
<p>组件的 DOM 事件监听的例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// react中的 dom 监听事件</span></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">ListenEvent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="comment">//this.state=&#123; userInput: '' &#125;;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 演示错误添加监听事件</span></span><br><span class="line">    componentWillMount() &#123;</span><br><span class="line">        <span class="comment">//window.addEventListener('resize', this.handleResize);</span></span><br><span class="line">    &#125;</span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        <span class="comment">// 1、在已经插入到真实的dom节点之后，注册窗体改变大小的事件监听</span></span><br><span class="line">        <span class="comment">// 3、用ajax发起数据请求的操作也要在componentDidMount方法里面去调用</span></span><br><span class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">'resize'</span>, <span class="keyword">this</span>.handleResize);</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillUnmount() &#123;</span><br><span class="line">        <span class="comment">// 2、在组件将要被卸载的时候移除监听事件，防止对其他组件的影响</span></span><br><span class="line">        <span class="built_in">window</span>.removeEventListener(<span class="string">'resize'</span>, <span class="keyword">this</span>.handleResize);</span><br><span class="line">    &#125;</span><br><span class="line">    handleResize=<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">window</span>.innerWidth);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                   dom事件监听</span><br><span class="line">                &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数据获取"><a href="#数据获取" class="headerlink" title="数据获取"></a>数据获取</h3><p><a href="http://facebook.github.io/react/tips/initial-ajax.html" target="_blank" rel="noopener">http://facebook.github.io/react/tips/initial-ajax.html</a></p>
<p>用 ajax 发起数据请求的操作也要在 componentDidMount 方法里面去调用</p>
<h3 id="表单"><a href="#表单" class="headerlink" title="表单"></a>表单</h3><p>表单不同于其他 HTML 元素，因为它要响应用户的交互，显示不同的状态，所以在 React 里面会有点特殊。</p>
<h4 id="状态属性"><a href="#状态属性" class="headerlink" title="状态属性"></a>状态属性</h4><p>表单元素有这么几种属于状态的属性：</p>
<blockquote>
<p>value，对应 <code>&lt;input&gt;</code> 和 <code>&lt;textarea&gt;</code> 所有<br>checked，对应类型为 checkbox 和 radio 的 <code>&lt;input&gt;</code> 所有<br>selected，对应 <code>&lt;option&gt;</code> 所有</p>
</blockquote>
<p>在 HTML 中 <code>&lt;textarea&gt;</code> 的值可以由子节点（文本）赋值，但是在 React 中，要用 value 来设置。表单元素包含以上任意一种状态属性都支持 onChange 事件监听状态值的更改。针对这些状态属性不同的处理策略，表单元素在 React 里面有两种表现形式。</p>
<h4 id="受控组件"><a href="#受控组件" class="headerlink" title="受控组件"></a>受控组件</h4><p>对于设置了上面提到的对应“状态属性“值的表单元素就是受控表单组件，比如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">"hello"</span>/&gt;</span>;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<p>一个受控的表单组件，它所有状态属性更改涉及 UI 的变更都由 React 来控制（状态属性绑定 UI）。比如上面代码里的 <code>&lt;input&gt;</code> 输入框，用户输入内容，用户输入的内容不会显示（输入框总是显示状态属性 value 的值 hello），所以说这是受控组件，不是原来默认的表单元素了。</p>
<p>如果希望输入的内容反馈到输入框，就要用 onChange 事件改变状态属性 value 的值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">getInitialState: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="attr">value</span>: <span class="string">'hello'</span>&#125;;</span><br><span class="line">&#125;,</span><br><span class="line">handleChange: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;<span class="attr">value</span>: event.target.value&#125;);</span><br><span class="line">&#125;,</span><br><span class="line">render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> value = <span class="keyword">this</span>.state.value;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">&#123;value&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.handleChange&#125;</span> /&gt;</span>;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<p>使用这种模式非常容易实现类似对用户输入的验证，或者对用户交互做额外的处理，比如截断最多输入140个字符：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">handleChange: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;<span class="attr">value</span>: event.target.value.substr(<span class="number">0</span>, <span class="number">140</span>)&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>受控组件例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//dom操作demo</span></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">ControlForm</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    state=&#123;</span><br><span class="line">        userInput: <span class="string">''</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="comment">//this.state=&#123; userInput: '' &#125;;</span></span><br><span class="line">    &#125;</span><br><span class="line">    handleChange(e) &#123;</span><br><span class="line">        <span class="comment">// 1、在react中思想是每一个组件的状态都应该为组件本身所控制</span></span><br><span class="line">        <span class="comment">// 2、受控表单组件中的value值是要和state属性绑定的，受控表单组件只能通过onChange方法去改变state的值，从而触发页面的从新渲染绑定</span></span><br><span class="line">        <span class="comment">// 3、扩展：WebComponent &lt;x-search&gt;</span></span><br><span class="line">        <span class="comment">// 方法一：用refs获取属性值</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.refs.theInput1.value);</span><br><span class="line">        <span class="keyword">let</span> inputStr=<span class="string">""</span>;</span><br><span class="line">        <span class="keyword">if</span>(e.target.value.length&gt;=<span class="number">16</span>)&#123;</span><br><span class="line">            inputStr=e.target.value.slice(<span class="number">0</span>,<span class="number">15</span>)+<span class="string">"..."</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            inputStr=e.target.value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 方法二：用事件参数获取属性值</span></span><br><span class="line">        <span class="keyword">this</span>.setState(&#123; <span class="attr">userInput</span>:inputStr&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    clearAndFocusInput() &#123;</span><br><span class="line">        <span class="comment">// 第一个参数是要重新赋值的state，第二个参数一个回调函数</span></span><br><span class="line">        <span class="keyword">this</span>.setState(&#123; <span class="attr">userInput</span>: <span class="string">''</span> &#125;, () =&gt; &#123;</span><br><span class="line">            <span class="keyword">this</span>.refs.theInput.focus();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;div onClick=&#123;<span class="keyword">this</span>.clearAndFocusInput.bind(<span class="keyword">this</span>)&#125;&gt;</span><br><span class="line">                    Click to Focus and Reset</span><br><span class="line">                &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">                &#123;/</span>*受控表单组件改变输入框的写法*<span class="regexp">/&#125;</span></span><br><span class="line"><span class="regexp">                &lt;input</span></span><br><span class="line"><span class="regexp">                    ref="theInput1"</span></span><br><span class="line"><span class="regexp">                    value=&#123;this.state.userInput&#125;</span></span><br><span class="line"><span class="regexp">                    onChange=&#123;this.handleChange.bind(this)&#125;</span></span><br><span class="line"><span class="regexp">                /</span>&gt;</span><br><span class="line">                &lt;br/&gt;</span><br><span class="line">                &#123;<span class="comment">/*受控表单组件写死了value值，永远不会改变了*/</span>&#125;</span><br><span class="line">                &lt;input</span><br><span class="line">                    ref=<span class="string">"theInput"</span></span><br><span class="line">                    value=<span class="string">'I'</span>am mhq<span class="string">'</span></span><br><span class="line"><span class="string">                /&gt;</span></span><br><span class="line"><span class="string">                &lt;br/&gt;</span></span><br><span class="line"><span class="string">                &#123;/*非受控表单组件它里面输入框值的改变不被react控制*/&#125;</span></span><br><span class="line"><span class="string">                &lt;input</span></span><br><span class="line"><span class="string">                    ref="theInput"</span></span><br><span class="line"><span class="string">                /&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="非受控属性"><a href="#非受控属性" class="headerlink" title="非受控属性"></a>非受控属性</h4><p>和受控组件相对，如果表单元素没有设置自己的“状态属性”，或者属性值设置为 null，这时候就是非受控组件。它的表现就符合普通的表单元素，正常响应用户的操作。同样，你也可以绑定 onChange 事件处理交互。如果你想要给“状态属性”设置默认值，就要用 React 提供的特殊属性 defaultValue，对于 checked 会有 defaultChecked，也是使用 defaultValue。</p>
<h4 id="为什么要有受控组件"><a href="#为什么要有受控组件" class="headerlink" title="为什么要有受控组件"></a>为什么要有受控组件</h4><p>引入受控组件不是说它有什么好处，而是因为 React 的 UI 渲染机制，对于表单元素不得不引入这一特殊的处理方式。</p>
<p>在浏览器 DOM 里面是有区分 attribute 和 property 的。</p>
<p>attribute 是在 HTML 里指定的属性，而每个 HTML 元素在 JS 对应是一个 DOM 节点对象，这个对象拥有的属性就是 property（可以在 console 里展开一个 DOM 节点对象看一下，HTML attributes 只是对应其中的一部分属性），attribute 对应的 property 会从 attribute 拿到初始值，有些会有相同的名称，但是有些名称会不一样，比如 attribute class 对应的 property 就是 className。（详细解释：.prop，.prop() vs .attr()）。回到 React 里的 <code>&lt;input&gt;</code> 输入框，当用户输入内容的时候，输入框的 value property 会改变，但是 value attribute 依然会是 HTML 上指定的值（attribute 要用 setAttribute 去更改）。</p>
<p>React 组件必须呈现这个组件的状态视图，这个视图 HTML 是由 render 生成，所以对于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">"hello"</span>/&gt;</span>;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<p>在任意时刻，这个视图总是返回一个显示 hello 的输入框。</p>
<h4 id="处理-select-表单"><a href="#处理-select-表单" class="headerlink" title="处理 select 表单"></a>处理 select 表单</h4><p>在 HTML 中 <code>&lt;select&gt;</code> 标签指定选中项都是通过对应 <code>&lt;option&gt;</code> 的 selected 属性来做的，但是在 React 修改成统一使用 value。所以没有一个 selected 的状态属性。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">value</span>=<span class="string">"B"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"A"</span>&gt;</span>Apple<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"B"</span>&gt;</span>Banana<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"C"</span>&gt;</span>Cranberry<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以通过传递一个数组指定多个选中项：<code>&lt;select multiple={true} value={[&#39;B&#39;, &#39;C&#39;]}&gt;</code></p>
<h2 id="参数传递的判断"><a href="#参数传递的判断" class="headerlink" title="参数传递的判断"></a>参数传递的判断</h2><p><a href="http://facebook.github.io/react/docs/transferring-props.html" target="_blank" rel="noopener">http://facebook.github.io/react/docs/transferring-props.html</a></p>
<h3 id="组合组件"><a href="#组合组件" class="headerlink" title="组合组件"></a>组合组件</h3><p>使用组件的目的就是通过构建模块化的组件，相互组合组件最后组装成一个复杂的应用。</p>
<p>在 React 组件中要包含其他组件作为子组件，只需要把组件当作一个 DOM 元素引入就可以了。</p>
<p><a href="http://reactjs.cn/react/docs/multiple-components.html" target="_blank" rel="noopener">http://reactjs.cn/react/docs/multiple-components.html</a></p>
<h4 id="循环插入子元素"><a href="#循环插入子元素" class="headerlink" title="循环插入子元素"></a>循环插入子元素</h4><p>如果组件中包含通过循环插入的子元素，为了保证重新渲染 UI 的时候能够正确显示这些子元素，每个元素都需要通过一个特殊的 key 属性指定一个唯一值。为了内部 diff 的效率。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Todolistdemo</span></span><br><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="comment">// 循环生成列表组件</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">let</span> createItem = <span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span>&#123;item.text&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;this.props.items.map(createItem)&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//var Item = React.createClass(&#123;</span></span><br><span class="line"><span class="comment">//    render: function() &#123;</span></span><br><span class="line"><span class="comment">//        return &lt;li key=&#123;item.id&#125; onClick=&#123;this.props.deleteItem&#125;&gt;&#123;item.text&#125;&lt;/li&gt;;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//&#125;);</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoApp</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="comment">// 初始化了我们的state，这是被推荐的写法</span></span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            items: [],<span class="comment">// 存我们输入的数据</span></span><br><span class="line">            text: <span class="string">''</span>  <span class="comment">// 每次输入文本</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 输入框change事件</span></span><br><span class="line">    onChange=<span class="function">(<span class="params">e</span>)=&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;<span class="attr">text</span>: e.target.value&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    handleSubmit=<span class="function">(<span class="params">e</span>)=&gt;</span> &#123;</span><br><span class="line">        e.preventDefault();</span><br><span class="line">        <span class="keyword">let</span> nextItems = <span class="keyword">this</span>.state.items.concat([&#123;<span class="attr">text</span>: <span class="keyword">this</span>.state.text, <span class="attr">id</span>: <span class="built_in">Date</span>.now()&#125;]);</span><br><span class="line">        <span class="keyword">let</span> nextText = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;<span class="attr">items</span>: nextItems, <span class="attr">text</span>: nextText&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;h3&gt;TODO&lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">                &lt;TodoList items=&#123;this.state.items&#125;/</span>&gt;</span><br><span class="line">                &lt;form onSubmit=&#123;<span class="keyword">this</span>.handleSubmit&#125;&gt;</span><br><span class="line">                    &lt;input onChange=&#123;<span class="keyword">this</span>.onChange&#125; value=&#123;<span class="keyword">this</span>.state.text&#125; /&gt;</span><br><span class="line">                    &lt;button&gt;&#123;<span class="string">'Add #'</span> + (<span class="keyword">this</span>.state.items.length + <span class="number">0</span>)&#125;&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">                &lt;/</span>form&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">export default TodoApp;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/moudle.exports=TodoApp;</span></span><br></pre></td></tr></table></figure>
<p>（1）当 React 校正带有 key 的子级时，它会确保它们被重新排序（而不是破坏）或者删除（而不是重用）。 务必 把 key 添加到子级数组里组件本身上，而不是每个子级内部最外层 HTML 上。</p>
<p>（2）也可以传递 object 来做有 key 的子级。object 的 key 会被当作每个组件的 key。但是一定要牢记 JavaScript 并不总是保证属性的顺序会被保留。实际情况下浏览器一般会保留属性的顺序，除了 使用 32位无符号数字做为 key 的属性。数字型属性会按大小排序并且排在其它属性前面。一旦发生这种情况，React 渲染组件的顺序就是混乱。可能在 key 前面加一个字符串前缀来避免：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> items = &#123;&#125;;</span><br><span class="line">    <span class="keyword">this</span>.props.results.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">         <span class="comment">// 如果 result.id 看起来是一个数字（比如短哈希），那么</span></span><br><span class="line">         <span class="comment">// 对象字面量的顺序就得不到保证。这种情况下，需要添加前缀</span></span><br><span class="line">         <span class="comment">// 来确保 key 是字符串。</span></span><br><span class="line">         items[<span class="string">'result-'</span> + result.id] = <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;result.text&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">         &lt;ol&gt;</span><br><span class="line">              &#123;items&#125;</span><br><span class="line">         &lt;<span class="regexp">/ol&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp"> &#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="子级"><a href="#子级" class="headerlink" title="子级"></a>子级</h4><p>组件标签里面包含的子元素会通过父元素的props.children 传递进来。</p>
<p>HTML 元素会作为 React 组件对象、JS 表达式结果是一个文字节点，都会存入 Parent 组件的 props.children。</p>
<p>props.children 通常是一个组件对象的数组，但是当只有一个子元素的时候，props.children 将是这个唯一的子元素，而不是数组了.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> NotesList = React.createClass(&#123;</span><br><span class="line">    render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;ol&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                React.Children.map(<span class="keyword">this</span>.props.children, <span class="function"><span class="keyword">function</span> (<span class="params">child</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;child&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">            &lt;<span class="regexp">/ol&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">    &lt;NotesList&gt;</span></span><br><span class="line"><span class="regexp">        &lt;span&gt;hello&lt;/</span>span&gt;</span><br><span class="line">        &lt;span&gt;world&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>NotesList&gt;,</span><br><span class="line">    <span class="built_in">document</span>.body</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>上面代码的 NoteList 组件有两个 span 子节点，它们都可以通过 this.props.children 读取。</p>
<p>这里需要注意， this.props.children 的值有三种可能：如果当前组件没有子节点，它就是 undefined ;如果有一个子节点，数据类型是 object ；如果有多个子节点，数据类型就是 array 。所以，处理 this.props.children 的时候要小心。React 提供一个工具方法 React.Children 来处理 this.props.children 。我们可以用 React.Children.map 来遍历子节点，而不用担心 this.props.children 的数据类型是 undefined 还是 object。更多的 React.Children 的方法，请参考官方文档。</p>
<h3 id="propsType"><a href="#propsType" class="headerlink" title="propsType"></a>propsType</h3><p><a href="http://www.reactjs.cn/react/docs/reusable-components.html" target="_blank" rel="noopener">http://www.reactjs.cn/react/docs/reusable-components.html</a></p>
<p>做属性校验使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// react中的属性校验</span></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">PropsCheck</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 初始化props属性</span></span><br><span class="line">    <span class="comment">//static defaultProps=&#123;</span></span><br><span class="line">    <span class="comment">//    autoPlay:false,</span></span><br><span class="line">    <span class="comment">//    maxLoops:10,</span></span><br><span class="line">    <span class="comment">//&#125;;</span></span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="comment">//this.state=&#123; userInput: '' &#125;;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 进行属性校验</span></span><br><span class="line">    <span class="keyword">static</span> propTypes = &#123;</span><br><span class="line">        autoPlay: React.PropTypes.bool.isRequired,</span><br><span class="line">        maxLoops: React.PropTypes.number.isRequired,</span><br><span class="line">    &#125;;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                属性校验</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/写在外面的写法</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/MyInputFocus.defaultProps=&#123;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/    autoPlay:false,</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/    maxLoops:10,</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/&#125;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/MyInputFocus.propTypes = &#123;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/    autoPlay: React.PropTypes.bool.isRequired,</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/    maxLoops: React.PropTypes.number.isRequired,</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h3><p><a href="http://facebook.github.io/react/docs/context.html" target="_blank" rel="noopener">http://facebook.github.io/react/docs/context.html</a></p>
<p>子组件使用父组件的值，通过 context 可以隔代获取值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">var</span> Button = React.createClass(&#123;</span><br><span class="line">    <span class="comment">// 在孙子里面校验祖宗里面的属性</span></span><br><span class="line">    contextTypes: &#123;</span><br><span class="line">        color: React.PropTypes.string</span><br><span class="line">    &#125;,</span><br><span class="line">    render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;h1&gt;&#123;<span class="keyword">this</span>.context.age&#125;&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">                &lt;button style=&#123;&#123;background: this.context.color&#125;&#125;&gt;</span></span><br><span class="line"><span class="regexp">                    &#123;this.props.children&#125;</span></span><br><span class="line"><span class="regexp">                &lt;/</span>button&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br><span class="line"><span class="regexp">var Message = React.createClass(&#123;</span></span><br><span class="line"><span class="regexp">    render: function() &#123;</span></span><br><span class="line"><span class="regexp">        return (</span></span><br><span class="line"><span class="regexp">            &lt;div&gt;</span></span><br><span class="line"><span class="regexp">                &#123;this.props.text&#125; &lt;Button&gt;Delete&lt;/</span>Button&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br><span class="line"><span class="regexp">var MessageList = React.createClass(&#123;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ 通过这个方法去传递属性</span></span><br><span class="line"><span class="regexp">    getChildContext: function() &#123;</span></span><br><span class="line"><span class="regexp">        return &#123;</span></span><br><span class="line"><span class="regexp">            color: "red",</span></span><br><span class="line"><span class="regexp">            age:12</span></span><br><span class="line"><span class="regexp">        &#125;;</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ 传递给子孙属性的类型校验</span></span><br><span class="line"><span class="regexp">    childContextTypes: &#123;</span></span><br><span class="line"><span class="regexp">        color: React.PropTypes.string,</span></span><br><span class="line"><span class="regexp">        age: React.PropTypes.number</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    render: function() &#123;</span></span><br><span class="line"><span class="regexp">        var children = this.props.messages.map(function(message) &#123;</span></span><br><span class="line"><span class="regexp">            return &lt;Message text=&#123;message.text&#125; /</span>&gt;;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> MessageList;</span><br></pre></td></tr></table></figure>
<h3 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h3><p><a href="http://facebook.github.io/react/docs/animation.html" target="_blank" rel="noopener">http://facebook.github.io/react/docs/animation.html</a><br><a href="http://blog.csdn.net/lihongxun945/article/details/46778723" target="_blank" rel="noopener">http://blog.csdn.net/lihongxun945/article/details/46778723</a><br><a href="https://zhuanlan.zhihu.com/p/20419592" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/20419592</a></p>
<p>例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// react中的dom监听事件</span></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactCSSTransitionGroup <span class="keyword">from</span> <span class="string">'react-addons-css-transition-group'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./animate.css'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Animate</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;<span class="attr">items</span>: [<span class="string">'hello'</span>, <span class="string">'world'</span>, <span class="string">'click'</span>, <span class="string">'me'</span>]&#125;;</span><br><span class="line">        <span class="keyword">this</span>.handleAdd = <span class="keyword">this</span>.handleAdd.bind(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    handleAdd() &#123;</span><br><span class="line">        <span class="keyword">const</span> newItems = <span class="keyword">this</span>.state.items.concat([</span><br><span class="line">            prompt(<span class="string">'Enter some text'</span>)</span><br><span class="line">        ]);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;<span class="attr">items</span>: newItems&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    handleRemove(i) &#123;</span><br><span class="line">        <span class="keyword">let</span> newItems = <span class="keyword">this</span>.state.items.slice();</span><br><span class="line">        newItems.splice(i, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;<span class="attr">items</span>: newItems&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> items = <span class="keyword">this</span>.state.items.map(<span class="function">(<span class="params">item, i</span>) =&gt;</span> (</span><br><span class="line">            &lt;div key=&#123;item&#125; onClick=&#123;() =&gt; <span class="keyword">this</span>.handleRemove(i)&#125;&gt;</span><br><span class="line">                &#123;item&#125;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        ));</span></span><br><span class="line"><span class="regexp">        return (</span></span><br><span class="line"><span class="regexp">            &lt;div&gt;</span></span><br><span class="line"><span class="regexp">                &lt;button onClick=&#123;this.handleAdd&#125;&gt;Add Item1&lt;/</span>button&gt;</span><br><span class="line">                &#123;<span class="comment">/*这个组件虽然叫动画，但是它只负责显示隐藏的动画*/</span>&#125;</span><br><span class="line">                &#123;<span class="comment">/*你想让谁有显示隐藏的动画你就用ReactCSSTransitionGroup包裹谁*/</span>&#125;</span><br><span class="line">                &#123;<span class="comment">/*后添加进去的元素和删除的元素才有动画效果，同时添加元素和ReactCSSTransitionGroup是没有动画效果的*/</span>&#125;</span><br><span class="line">                &lt;ReactCSSTransitionGroup</span><br><span class="line">                    component=<span class="string">"div"</span></span><br><span class="line">                    transitionName=<span class="string">"example"</span></span><br><span class="line">                    transitionAppear=&#123;<span class="literal">true</span>&#125;</span><br><span class="line">                    transitionEnterTimeout=&#123;<span class="number">500</span>&#125;</span><br><span class="line">                    transitionLeaveTimeout=&#123;<span class="number">300</span>&#125;&gt;</span><br><span class="line">                    &#123;items&#125;</span><br><span class="line">                &lt;<span class="regexp">/ReactCSSTransitionGroup&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="获取react常用插件的网址"><a href="#获取react常用插件的网址" class="headerlink" title="获取react常用插件的网址"></a>获取react常用插件的网址</h3><p><a href="https://js.coach/react/react-infinite" target="_blank" rel="noopener">https://js.coach/react/react-infinite</a><br><a href="https://react.parts/native" target="_blank" rel="noopener">https://react.parts/native</a></p>
<h3 id="diff算法"><a href="#diff算法" class="headerlink" title="diff算法"></a>diff算法</h3><p><a href="http://blog.csdn.net/lihongxun945/article/details/46640503" target="_blank" rel="noopener">http://blog.csdn.net/lihongxun945/article/details/46640503</a><br><a href="http://reactjs.cn/react/docs/reconciliation.html" target="_blank" rel="noopener">http://reactjs.cn/react/docs/reconciliation.html</a><br><a href="http://blog.csdn.net/yczz/article/details/49585283" target="_blank" rel="noopener">http://blog.csdn.net/yczz/article/details/49585283</a><br><a href="http://blog.csdn.net/yczz/article/details/49886061" target="_blank" rel="noopener">http://blog.csdn.net/yczz/article/details/49886061</a></p>
<h3 id="Web-Components"><a href="#Web-Components" class="headerlink" title="Web Components"></a>Web Components</h3><p><a href="http://www.oschina.net/p/polymer" target="_blank" rel="noopener">http://www.oschina.net/p/polymer</a><br><a href="http://facebook.github.io/react/docs/webcomponents.html" target="_blank" rel="noopener">http://facebook.github.io/react/docs/webcomponents.html</a></p>
<h3 id="服务器渲染"><a href="#服务器渲染" class="headerlink" title="服务器渲染"></a>服务器渲染</h3><p><a href="http://zhuanlan.zhihu.com/p/20669111?from=groupmessage&amp;isappinstalled=0" target="_blank" rel="noopener">http://zhuanlan.zhihu.com/p/20669111?from=groupmessage&amp;isappinstalled=0</a></p>
<h3 id="组件间通信"><a href="#组件间通信" class="headerlink" title="组件间通信"></a>组件间通信</h3><h4 id="非父子组件间的通信"><a href="#非父子组件间的通信" class="headerlink" title="非父子组件间的通信"></a>非父子组件间的通信</h4><p>使用全局事件 Pub/Sub 模式，在 componentDidMount 里面订阅事件，在 componentWillUnmount 里面取消订阅，当收到事件触发的时候调用 setState 更新 UI。</p>
<p>这种模式在复杂的系统里面可能会变得难以维护，所以看个人权衡是否将组件封装到大的组件，甚至整个页面或者应用就封装到一个组件。</p>
<p>一般来说，对于比较复杂的应用，推荐使用类似 Flux 这种单项数据流架构，参见 Data Flow。Flux 和 redux</p>
<h4 id="数据流Flux"><a href="#数据流Flux" class="headerlink" title="数据流Flux"></a>数据流Flux</h4><p>Github地址：<a href="https://github.com/facebook/flux" target="_blank" rel="noopener">https://github.com/facebook/flux</a></p>
<p>React redux react-redux react-router webpack+gulp ES6 babel<br>Mocha+chai node<br>React native Flex fetch 原生 插件</p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>感谢您的支持！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="honey young 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="honey young 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/React/" rel="tag"><i class="fa fa-tag"></i> React</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/06/20/混合APP开发环境配置-ionic、cordora/" rel="next" title="混合APP开发环境配置-ionic、cordora">
                <i class="fa fa-chevron-left"></i> 混合APP开发环境配置-ionic、cordora
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/07/07/webpack 构建工具/" rel="prev" title="webpack 构建工具">
                webpack 构建工具 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            博文目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            本站概要
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/header.jpg"
                alt="honey young" />
            
              <p class="site-author-name" itemprop="name">honey young</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">69</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">31</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">71</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/honeyYoung/honeyyoung.github.io" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.jianshu.com/u/de13fcfe3889" target="_blank" title="简书">
                      
                        <i class="fa fa-fw fa-globe"></i>简书</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/dong-gua-xiao-ke-ai/activities" target="_blank" title="知乎">
                      
                        <i class="fa fa-fw fa-globe"></i>知乎</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#React简介"><span class="nav-number">1.</span> <span class="nav-text">React简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#官网地址"><span class="nav-number">1.1.</span> <span class="nav-text">官网地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#在线编辑工具-JSFiddle"><span class="nav-number">1.2.</span> <span class="nav-text">在线编辑工具 JSFiddle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为什么使用-React"><span class="nav-number">1.3.</span> <span class="nav-text">为什么使用 React</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实战案例"><span class="nav-number">1.4.</span> <span class="nav-text">实战案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#入门视频"><span class="nav-number">1.5.</span> <span class="nav-text">入门视频</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考资料"><span class="nav-number">1.6.</span> <span class="nav-text">参考资料</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#React的四个概念简单介绍"><span class="nav-number">2.</span> <span class="nav-text">React的四个概念简单介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Virtual-DOM"><span class="nav-number">2.1.</span> <span class="nav-text">Virtual DOM</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#虚拟DOM是React的基石"><span class="nav-number">2.1.1.</span> <span class="nav-text">虚拟DOM是React的基石</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Virtual-DOM速度快的说明"><span class="nav-number">2.1.2.</span> <span class="nav-text">Virtual DOM速度快的说明</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React组件"><span class="nav-number">2.2.</span> <span class="nav-text">React组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#组件化概念"><span class="nav-number">2.2.1.</span> <span class="nav-text">组件化概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#组件化开发特性"><span class="nav-number">2.2.2.</span> <span class="nav-text">组件化开发特性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#组件定义"><span class="nav-number">2.2.3.</span> <span class="nav-text">组件定义</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSX语法"><span class="nav-number">2.3.</span> <span class="nav-text">JSX语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Data-Flow（单向数据流）"><span class="nav-number">2.4.</span> <span class="nav-text">Data Flow（单向数据流）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#传统的-MVC"><span class="nav-number">2.4.1.</span> <span class="nav-text">传统的 MVC</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Flux"><span class="nav-number">2.4.2.</span> <span class="nav-text">Flux</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Flux-的核心“单向数据流“怎么运作的："><span class="nav-number">2.4.3.</span> <span class="nav-text">Flux 的核心“单向数据流“怎么运作的：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Redux"><span class="nav-number">2.4.4.</span> <span class="nav-text">Redux</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#其他"><span class="nav-number">2.4.5.</span> <span class="nav-text">其他</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#React快速开始"><span class="nav-number">3.</span> <span class="nav-text">React快速开始</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建项目文件夹"><span class="nav-number">3.1.</span> <span class="nav-text">创建项目文件夹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#依赖环境"><span class="nav-number">3.2.</span> <span class="nav-text">依赖环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建目录结构"><span class="nav-number">3.3.</span> <span class="nav-text">创建目录结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#代码编译方式（语法转换）"><span class="nav-number">3.4.</span> <span class="nav-text">代码编译方式（语法转换）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#react-tools转换"><span class="nav-number">3.4.1.</span> <span class="nav-text">react-tools转换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#babel转换"><span class="nav-number">3.4.2.</span> <span class="nav-text">babel转换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gulp-react"><span class="nav-number">3.4.3.</span> <span class="nav-text">Gulp-react</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Webpack"><span class="nav-number">3.4.4.</span> <span class="nav-text">Webpack</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#开发工具"><span class="nav-number">3.4.5.</span> <span class="nav-text">开发工具</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#主要知识"><span class="nav-number">4.</span> <span class="nav-text">主要知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#视图相关概念"><span class="nav-number">4.1.</span> <span class="nav-text">视图相关概念 !!!</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#jsx语法详解"><span class="nav-number">4.2.</span> <span class="nav-text">jsx语法详解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#HTML-转义"><span class="nav-number">4.2.1.</span> <span class="nav-text">HTML 转义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#自定义-HTML-属性"><span class="nav-number">4.2.2.</span> <span class="nav-text">自定义 HTML 属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#支持的标签和属性"><span class="nav-number">4.2.3.</span> <span class="nav-text">支持的标签和属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#属性扩散"><span class="nav-number">4.2.4.</span> <span class="nav-text">属性扩散</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#自闭合标签"><span class="nav-number">4.2.5.</span> <span class="nav-text">自闭合标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#注释"><span class="nav-number">4.2.6.</span> <span class="nav-text">注释</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#React-的-API"><span class="nav-number">5.</span> <span class="nav-text">React 的 API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#顶层-API"><span class="nav-number">5.1.</span> <span class="nav-text">顶层 API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组件-API"><span class="nav-number">5.2.</span> <span class="nav-text">组件 API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组件的生命周期（特别重要）"><span class="nav-number">5.3.</span> <span class="nav-text">组件的生命周期（特别重要）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#组件的生命周期分成三个状态："><span class="nav-number">5.3.1.</span> <span class="nav-text">组件的生命周期分成三个状态：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#处理函数"><span class="nav-number">5.3.2.</span> <span class="nav-text">处理函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#函数调用顺序图"><span class="nav-number">5.3.3.</span> <span class="nav-text">函数调用顺序图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#代码使用"><span class="nav-number">5.3.4.</span> <span class="nav-text">代码使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#参考文章"><span class="nav-number">5.3.5.</span> <span class="nav-text">参考文章</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#注意点"><span class="nav-number">5.3.6.</span> <span class="nav-text">注意点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ES5-ES6-最新写法对照表"><span class="nav-number">5.3.7.</span> <span class="nav-text">ES5/ES6 最新写法对照表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#生命周期代码-ES5-和-ES6-的区别"><span class="nav-number">5.3.8.</span> <span class="nav-text">生命周期代码 ES5 和 ES6 的区别</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#事件处理"><span class="nav-number">5.4.</span> <span class="nav-text">事件处理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#使用"><span class="nav-number">5.4.1.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#参数传递"><span class="nav-number">5.4.2.</span> <span class="nav-text">参数传递</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#React-支持的事件列表"><span class="nav-number">5.4.3.</span> <span class="nav-text">React 支持的事件列表</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dom操作"><span class="nav-number">5.5.</span> <span class="nav-text">Dom操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#方法一：findDOMNode-方法"><span class="nav-number">5.5.1.</span> <span class="nav-text">方法一：findDOMNode()方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#方法二：refs属性"><span class="nav-number">5.5.2.</span> <span class="nav-text">方法二：refs属性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注意事项"><span class="nav-number">5.6.</span> <span class="nav-text">注意事项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#和其他库配合使用"><span class="nav-number">5.7.</span> <span class="nav-text">和其他库配合使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组件的-DOM-事件监听"><span class="nav-number">5.8.</span> <span class="nav-text">组件的 DOM 事件监听</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据获取"><span class="nav-number">5.9.</span> <span class="nav-text">数据获取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#表单"><span class="nav-number">5.10.</span> <span class="nav-text">表单</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#状态属性"><span class="nav-number">5.10.1.</span> <span class="nav-text">状态属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#受控组件"><span class="nav-number">5.10.2.</span> <span class="nav-text">受控组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#非受控属性"><span class="nav-number">5.10.3.</span> <span class="nav-text">非受控属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#为什么要有受控组件"><span class="nav-number">5.10.4.</span> <span class="nav-text">为什么要有受控组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#处理-select-表单"><span class="nav-number">5.10.5.</span> <span class="nav-text">处理 select 表单</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参数传递的判断"><span class="nav-number">6.</span> <span class="nav-text">参数传递的判断</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#组合组件"><span class="nav-number">6.1.</span> <span class="nav-text">组合组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#循环插入子元素"><span class="nav-number">6.1.1.</span> <span class="nav-text">循环插入子元素</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#子级"><span class="nav-number">6.1.2.</span> <span class="nav-text">子级</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#propsType"><span class="nav-number">6.2.</span> <span class="nav-text">propsType</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Context"><span class="nav-number">6.3.</span> <span class="nav-text">Context</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#动画"><span class="nav-number">6.4.</span> <span class="nav-text">动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#获取react常用插件的网址"><span class="nav-number">6.5.</span> <span class="nav-text">获取react常用插件的网址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#diff算法"><span class="nav-number">6.6.</span> <span class="nav-text">diff算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Web-Components"><span class="nav-number">6.7.</span> <span class="nav-text">Web Components</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#服务器渲染"><span class="nav-number">6.8.</span> <span class="nav-text">服务器渲染</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组件间通信"><span class="nav-number">6.9.</span> <span class="nav-text">组件间通信</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#非父子组件间的通信"><span class="nav-number">6.9.1.</span> <span class="nav-text">非父子组件间的通信</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据流Flux"><span class="nav-number">6.9.2.</span> <span class="nav-text">数据流Flux</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">honey young</span>

  
</div>


  <div class="powered-by">
     <i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
      本站访客数:<span id="busuanzi_value_site_uv"></span>
     </span>
  </div>
<!-- <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div> 



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>
-->




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
<script type="text/javascript" src="/js/src/love.js"></script>
